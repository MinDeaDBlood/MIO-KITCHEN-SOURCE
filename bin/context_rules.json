{
  "//": "MIO-KITCHEN SELinux Context FALLBACK Rules. Used only when file is missing from original file_contexts.",
  "//": "VERSION: 4.4",

  "__comment_miui_hyperos_hardening__": "MIUI/HYPEROS HARDENING: Specific rules for Xiaomi non-standard paths and binaries.",
  // Handle non-standard executable paths used by Xiaomi
  "^/system/vendor/bin/.*": "u:object_r:vendor_bin_file:s0",
  "^/system_ext/xbin/.*": "u:object_r:shell_exec:s0",
  // Secure fallback for ANY Xiaomi-specific binary. Gives them a safe EXECUTABLE context.
  "^/system/bin/(mi|hyperos)_.*": "u:object_r:system_bin_file:s0",
  // Specific, high-precision rule for modern DRM HALs
  "^/vendor/bin/hw/android\\.hardware\\.drm@.*-service$": "u:object_r:hal_drm_default_exec:s0",

  "__comment_critical_executables__": "CRITICAL EXECUTABLES: General rules for all systems.",
  // Explicit rule for the shell command provider, giving it the precise shell_exec context.
  "^/system/bin/(toybox|toybox_vendor)$": "u:object_r:shell_exec:s0",
  // Explicitly ensure core debugging tools are executable.
  "^/system/bin/(logcat|dmesg|debuggerd)$": "u:object_r:system_bin_file:s0",
  // General rules
  "^/(system|product|system_ext)/bin/.*": "u:object_r:system_bin_file:s0",
  "^/(vendor|odm)/bin/.*": "u:object_r:vendor_bin_file:s0",
  "^/(system|vendor|system_ext|odm)/xbin/.*": "u:object_r:shell_exec:s0",
  
  "__comment_system_apps__": "SYSTEM APPS: Specific app contexts to be recognized and installed.",
  "^/(system|product|system_ext)/app/.*\\.apk$": "u:object_r:system_app_file:s0",
  "^/(system|product|system_ext)/priv-app/.*\\.apk$": "u:object_r:system_app_file:s0",
  "^/(vendor|odm)/app/.*\\.apk$": "u:object_r:vendor_app_file:s0",
  "^/(vendor|odm)/priv-app/.*\\.apk$": "u:object_r:vendor_app_file:s0",
  
  "__comment_overlays__": "OVERLAYS: Specific overlay contexts to be processed by Resource Manager.",
  "^/(system|product|system_ext)/overlay/.*\\.apk$": "u:object_r:system_overlay_file:s0",
  "^/(vendor|odm)/overlay/.*\\.apk$": "u:object_r:vendor_overlay_file:s0",
  
  "__comment_libraries__": "LIBRARIES: Specific lib contexts to be dynamically linkable.",
  "^/(system|product|system_ext)/lib(64)?/.*\\.so$": "u:object_r:system_lib_file:s0",
  "^/(vendor|odm)/lib(64)?/.*\\.so$": "u:object_r:vendor_lib_file:s0",
  
  "__comment_framework__": "FRAMEWORK: Specific rules for /framework directory (Highest priority for these paths).",
  "^/(system|product|system_ext)/framework/.*\\.jar$": "u:object_r:system_file:s0",
  "^/(system|product|system_ext)/framework/.*\\.conf$": "u:object_r:system_configs_file:s0",
  "^/(system|product|system_ext)/framework/.*\\.(vdex|odex|art)$": "u:object_r:system_file:s0",
  "^/(vendor|odm)/framework/.*\\.jar$": "u:object_r:vendor_file:s0",
  "^/(vendor|odm)/framework/.*\\.conf$": "u:object_r:vendor_configs_file:s0",
  "^/(vendor|odm)/framework/.*\\.(vdex|odex|art)$": "u:object_r:vendor_file:s0",
  
  "__comment_optimized_dex__": "OPTIMIZED DEX: Rules for AOT-compiled code outside of /framework.",
  // Specific rule for standard /oat/ directories
  "^/(system|product|system_ext)/.*/oat/.+\\.(vdex|odex)$": "u:object_r:system_file:s0",
  "^/(vendor|odm)/.*/oat/.+\\.(vdex|odex)$": "u:object_r:vendor_file:s0",
  // General fallback for any other .vdex/.odex files
  "^/(system|product|system_ext)/.+\\.(vdex|odex)$": "u:object_r:system_file:s0",
  "^/(vendor|odm)/.+\\.(vdex|odex)$": "u:object_r:vendor_file:s0",

  "__comment_config_critical__": "CONFIGURATION: Critical config files with precise contexts.",
  // Comprehensive build.prop rules for maximum compatibility
  "^/(system|product|system_ext)/build\\.prop$": "u:object_r:system_file:s0",
  "^/(product|system_ext)/etc/build\\.prop$": "u:object_r:system_file:s0",
  "^/(vendor|odm)/build\\.prop$": "u:object_r:vendor_file:s0",
  "^/(vendor|odm)/etc/build\\.prop$": "u:object_r:vendor_file:s0",
  "^/vendor/(odm|vendor)_dlkm/etc/build\\.prop$": "u:object_r:vendor_file:s0",
  // Other config files
  "^/(system|product|system_ext)/etc/init/.*\\.rc$": "u:object_r:system_file:s0",
  "^/(vendor|odm)/etc/init/.*\\.rc$": "u:object_r:vendor_configs_file:s0",
  "^/(system|product|system_ext)/etc/permissions/.*\\.xml$": "u:object_r:system_file:s0",
  "^/(vendor|odm)/etc/permissions/.*\\.xml$": "u:object_r:vendor_configs_file:s0",

  "__comment_firmware__": "FIRMWARE: Universal context for hardware firmware.",
  "^/(system|vendor|product|system_ext|odm)/etc/firmware/.*": "u:object_r:firmware_file:s0",

  "__comment_directories__": "DIRECTORIES: Base contexts for top-level directories.",
  "^/system(/.*)?/$": "u:object_r:system_file:s0",
  "^/vendor(/.*)?/$": "u:object_r:vendor_file:s0",
  "^/product(/.*)?/$": "u:object_r:system_file:s0",
  "^/system_ext(/.*)?/$": "u:object_r:system_file:s0",
  "^/odm(/.*)?/$": "u:object_r:odm_file:s0",

  "__comment_safeguards__": "CONTEXT SAFEGUARDS: Prevent overmatching by placing specific sub-path rules before general ones.",
  "^/system/vendor/.+": "u:object_r:vendor_file:s0",
  "^/system/apex/.+": "u:object_r:system_file:s0",

  "__comment_ultimate_fallback__": "ULTIMATE FALLBACK: Conflict-free partition handling.",
  // 1. Core system and its extensions
  "^/system/.+": "u:object_r:system_file:s0",
  "^/(product|system_ext)/.+": "u:object_r:system_file:s0",
  // 2. Vendor implementations
  "^/vendor/.+": "u:object_r:vendor_file:s0",
  "^/odm/.+": "u:object_r:odm_file:s0",
  // 3. Dynamic components (APEX top-level)
  "^/apex/.+": "u:object_r:system_file:s0"
}
